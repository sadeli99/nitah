<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Roasting Foto</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://roastgram.xyz/css/style.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Radio+Canada+Big:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>


</head>
<body class="min-vh-100 bg-white">
    <main class="container my-5">
        <h1 class="mx-3 f500 lh-2">Ubah Foto Biasa Jadi Bahan Roasting yang Menghibur!</h1>
        
        <form enctype="multipart/form-data" action="/roast" method="POST" class="mt-4 mx-3">
            <div class="mb-3">
            <label for="photo" class="form-label">Pilih gambar yang mau di roasting</label>


            <div class="input-group">
            <span class="input-group-text">
            <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m3 16 5-7 6 6.5m6.5 2.5L16 13l-4.286 6M14 10h.01M4 19h16a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1Z"/>
            </svg>
            
            </span>
            <input
            type="file"
            accept="image/jpeg, image/jpg, image/png, image/webm"
            class="form-control"
            id="photo"
            required
            />
            </div>
            
            
            </div>
            <button class="btn btn-danger w-100 p-3 f500">Mulai roasting</button>
             <p id="fileName"></p>
        </form>

        <div aria-busy="true" id="loading" class="text-center mt-5 mx-3 d-none">
            <div class="spinner-border" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-3">Sabar lagi mikir buat roasting foto kamu..</p>
        </div>
       
       <div class="mx-3 mt-5 border-bottom pb-5 d-none" id="konten">
       <img id="preview" src="https://images.pexels.com/photos/4029925/pexels-photo-4029925.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2" alt="Foto Terkait"  class="rounded-2" style="opacity: 0; width: 100%; height: auto; object-fit: cover;" />
       <h3 class="f500 mx-1 mt-5 mb-3">Hasil Roasting</h3>
       <p id="roast" class="mx-1"></p>

       </div>
       
       <!-- End Modal -->
    </main>
    
    <section class="mb-5" id="fitur" style="margin-top: 80px;">
    
    <div class="container">
    <div class="mt-5 mb-5 mx-3 text-center">
    <p class="mb-2 f600 lh" style="font-size: 0.8rem; color: #A02BEA;">MENGAPA HARUS ROASTGRAM</p>
    <h1 class="mb-3 f500 lh-2">Ingin membuat teman tertawa atau hanya ingin menguji selera humormu sendiri</h1>
    <p class="f400 lh">Roasting Foto Pribadi. Unggah fotomu atau temanmu, dan lihat bagaimana kami mengubahnya menjadi lelucon yang memukau!</p>
    </div>
    <div class="row mx-2">
    <div class="col-12 col-md-4 mb-3">
    <div class="card p-3 rounded-4">
    <div class="card-body">
    <div class="card-icons">
    <!-- You can use Font Awesome or any other icon library here -->
    <img src="https://cdn-icons-png.flaticon.com/512/1161/1161490.png">
    </div>
    <h4 class="card-title f500">Apakah Aman?</h4>
    <p class="card-text f400 lh">Tentu saja! Keamanan privasi adalah prioritas kami. Foto yang kamu unggah tidak akan disimpan di server kami. Setelah roasting selesai, fotomu akan otomatis terhapus dari sistem kami, memastikan privasimu tetap terlindungi. Jadi, kamu bisa bersenang-senang tanpa khawatir!</p>
    </div>
    </div>
    </div>
    <div class="col-12 col-md-4 mb-3">
    <div class="card p-3 rounded-4">
    <div class="card-body">
    <div class="card-icons">
    <!-- You can use Font Awesome or any other icon library here -->
    <img src="https://cdn-icons-png.flaticon.com/512/2931/2931042.png">
    </div>
    <h4 class="card-title f500">Gratis 100%</h4>
    <p class="card-text f400 lh">Nikmati fitur ini sepenuhnya tanpa biaya. Kami percaya bahwa humor adalah hak setiap orang, dan kami ingin memastikan bahwa kamu bisa berbagi tawa tanpa harus mengeluarkan uang.</p>
    </div>
    </div>
    </div>
    </div>

    <div class="container">
    <footer class="py-3 my-4 text-center">
    <img src="images/logo.png" alt="Logo" class="navbar-logo mb-3">
    <ul class="nav justify-content-center border-bottom pb-3 mb-3">
    <li class="nav-item"><a href="#" class="nav-link px-2 text-body-secondary f400">Rumah</a></li>
    <li class="nav-item"><a href="#fitur" class="nav-link px-2 text-body-secondary f400">Fitur</a></li>
    <li class="nav-item"><a href="https://trakteer.id/zakiakaidzan/tip" class="nav-link px-2 text-body-secondary f400">Dukungan</a></li>
    <li class="nav-item"><a href="tentang" class="nav-link px-2 text-body-secondary f400">Tentang</a></li>
    </ul>
    <p class="text-center text-body-secondary f400">&copy; 2024 Roastgram</p>
    </footer>
    </div>
    

    
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
        
    <script>
        const form = document.querySelector("form"), button = document.querySelector('form button');
        const photo = document.querySelector("#photo");
        const roast = document.querySelector("#roast");
        const loading = document.querySelector("#loading");
        const preview = document.querySelector("#preview");
        const fileNameDisplay = document.querySelector("#fileName"); 
        const konten = document.querySelector("#konten");


        photo.onchange = (evt) => {
        const [file] = photo.files;
        if (file) {
        preview.src = URL.createObjectURL(file);
        fileNameDisplay.textContent = file.name; // Tampilkan nama file
        } else {
        fileNameDisplay.textContent = ""; // Kosongkan nama file jika tidak ada file
        }
        };

        form.onsubmit = (e) => {
            e.preventDefault();
            roast.innerHTML = "";
            button.disabled = true;

            loading.classList.remove("d-none"); 

            const data = new FormData();
            data.append("file", photo.files[0]);

            fetch("/roast", {
                method: "POST",
                body: data,
            })
                .then((response) => response.json())
                .then((data) => {
                    if (data.ok) {
                    
                      konten.classList.remove("d-none"); 
                        preview.style.opacity = 1;
                        preview.style.height = "auto";
                        loading.classList.add("d-none");
                        form.reset();
                        fileNameDisplay.textContent = ""; // Kosongkan nama file setelah form di-reset
     
                        roast.innerHTML = marked.parse(data.text);
                    } else if (data.statusCode == 429) {
                        preview.style.opacity = 1;
                        preview.style.height = "auto";
                        loading.classList.add("d-none");
                        form.reset();
                        fileNameDisplay.textContent = ""; // Kosongkan nama file setelah form di-reset

konten.classList.remove("d-none"); 
                        
                        preview.src = '';
                        roast.innerHTML = `Traffic nya lagi rame banget, sabar sebentar ya ðŸ˜­ðŸ˜­<br><small>${data.message}</small>`;
                    } else {
                    
                    konten.classList.remove("d-none"); 
                        loading.classList.add("d-none");
                       
                        roast.innerHTML = "Roastingan untuk foto ini terlalu brutal sampe kena sensor ðŸ”¥ðŸ”¥ðŸ’€ðŸ’€ðŸ¤£ðŸ¤£ðŸ¤£\nKlik Roast buat coba lagi";
                    }
                    button.disabled = false;
                })
                .catch((error) => {
                
                konten.classList.remove("d-none"); 
                    console.error('Error:', error);
                    loading.classList.add("d-none");
                    roast.innerHTML = "Terjadi kesalahan. Silakan coba lagi.";
                    button.disabled = false;
                });
        };
    </script>
</body>
</html>
